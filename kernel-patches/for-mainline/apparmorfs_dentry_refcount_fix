---
 security/apparmor/apparmorfs.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/security/apparmor/apparmorfs.c
+++ b/security/apparmor/apparmorfs.c
@@ -179,8 +179,10 @@ static void aafs_remove(const char *name
 	struct dentry *dentry;
 
 	dentry = lookup_one_len(name, apparmor_dentry, strlen(name));
-	if (dentry && !IS_ERR(dentry))
+	if (!IS_ERR(dentry)) {
 		securityfs_remove(dentry);
+		dput(dentry);
+	}
 }
 
 static int aafs_create(const char *name, int mask, struct file_operations *fops)
