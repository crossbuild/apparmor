# $Id$
# ------------------------------------------------------------------
#
#    Copyright (C) 2002-2005 Novell/SUSE
#
#    This program is free software; you can redistribute it and/or
#    modify it under the terms of version 2 of the GNU General Public
#    License published by the Free Software Foundation.
#
# ------------------------------------------------------------------
# vim:syntax=apparmor
# Last Modified: Thu Aug 25 14:49:56 2005

#include <tunables/global>

/usr/bin/opera {
  #include <abstractions/base>
  #include <abstractions/bash>
  #include <abstractions/consoles>
  #include <abstractions/kde>
  #include <abstractions/nameservice>
  #include <abstractions/user-write>
  #include <abstractions/user-download>
  #include <abstractions/X>

  capability dac_override,

  / r,
  /bin/bash ix,
  /bin/sed ixr,
  /bin/true ixr,
  /etc/SuSE-release r,
  /etc/X11/.qt_plugins_3.3rc.lock rw,
  /etc/X11/.qtrc.lock rw,
  /etc/cups/client.conf r,
  /etc/cups/lpoptions r,
  /etc/opera6rc	rw,
  /etc/opera6rc.fixed rw,
  /opt r,
  /proc/*/stat r,
  /proc/net/if_inet6 r,
  /proc/stat r,
  /proc/sys/vm/heap-stack-gap r,

  @{HOME}/.fonts.cache-* r,
  @{HOME}/.fonts r,
  @{HOME}/.fonts/** r,
  @{HOME} ixr,
  @{HOME}/  ixr,
  @{HOME}/.kde/share/** r,
  @{HOME}/OperaDownloads/* rw,
  @{HOME}/.opera/** lrw,
  @{HOME}/.opera r,

  /opt/mozilla/lib/plugins r,
  /opt/mozilla/lib/plugins/** r,
  /opt/gnome/share/** r,
  /usr r,
  /opt/kde3/bin/kfmclient rux,
  /opt/kde3/lib/kde3/plugins/integration/*.so r,
  /usr/X11R6/bin/acroread rpx,
  /usr/X11R6/lib r,
  /usr/X11R6/lib/Acrobat7/Browser/intellinux/nppdf.so r,
  /usr/X11R6/lib/Acrobat7/Resource/Font/** r,
  /usr/X11R6/lib/X11/XErrorDB r,
  /usr/bin/lp rux,
  /usr/bin/opera r,
  /usr/lib r,
  /usr/lib/RealPlayer10/realplay rpx,
  /usr/lib/RealPlayer10/realplay.bin rpx,
  /usr/lib/browser-plugins r,
  /usr/lib/browser-plugins/* r,
  /usr/lib/jvm/** r,
  /usr/lib/ooo-2.0/share/fonts/** r,
  /usr/lib/opera/** ixr,
  /usr/local r,
  /usr/share/opera/** r,
  /var/X11R6/compose-cache/* r,
  /var/run/.resmgr_socket w,
  /var/spool/cups/tmp/* lrw,
  /opt/gnome/bin/gnome-open rux,
# external source editors
  /usr/X11R6/bin/xedit rux,
  /usr/bin/xterm rux,
  /usr/X11R6/bin/rxvt rux,
  /opt/kde3/bin/kate rux,
  /opt/kde3/bin/kwrite rux,
  /usr/bin/vi rux,
  /usr/bin/vim rux,
  /usr/bin/emacs rux,
  /usr/bin/pico rux,
  /opt/kde3/bin/kvim rux,
  /usr/X11R6/bin/xemacs rux,
  /bin/vim rux,
  /bin/vi rux,
}
